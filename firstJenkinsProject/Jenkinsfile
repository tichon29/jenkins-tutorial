pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                sh 'echo "Checking files"'
                sh '''
                    #!/bin/sh
                    ls -la
                    echo "Checking fit"
                    if [grep -rnw 'firstJenkinsProject/test' -e 'fit('] || [grep -rnw 'firstJenkinsProject/test' -e 'fdescribe(']
                    then
                        echo "Should fail"
                        currentBuild.result = 'FAILURE'
                    else
                        echo "We are clean"
                    fi
                    echo "end"
                '''
            }
        }
        stage('2nd Step') {
            steps {
                sh 'echo "Hello World"'
            }
        }
    }
}
